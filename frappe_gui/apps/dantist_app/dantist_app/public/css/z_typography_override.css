// Инжектор «последнего» стиля: гарантирует, что типографика перебьёт всё.
(() => {
  const CSS = `
/* === DANTIST FORCED TYPOGRAPHY (injected) === */
:root{
  --base-font-size: 18px;  /* x2 от 18px; поменяй при желании */
  --line-height-base: 1.6;
  --font-family: "Roboto", system-ui, -apple-system, "Segoe UI","Helvetica Neue",Arial,sans-serif;
}

@font-face{
  font-family:"Roboto";
  src: local("Roboto"), local("Roboto Regular");
  font-weight:400;font-style:normal;font-display:swap;
}
/* Если нужна гарантия локального шрифта — добавь woff2 и замени src на файл в /assets */

/* База */
html,body,html[data-theme="light"],html[data-theme="dark"]{
  font-family:var(--font-family) !important;
  font-size:var(--base-font-size) !important;
  line-height:var(--line-height-base) !important;
}

/* Частые контейнеры Desk */
.desk-container,.layout-main-section,.page-container,.container,
.navbar,.navbar *,.sidebar,.sidebar-section,
.modal,.modal *,.dropdown-menu,.dropdown-item,
.form-control,.control-input,input,textarea,select,
.btn,.btn-group>.btn,.awesomplete,.awesomplete li,
.dt,.dt-row,.dt-cell__content,.dt-header .dt-cell__content,.dt-dropdown,.dt-pagination,.dt-input,.dt-picker,
.listview-main-section,.list-sidebar,.list-row,.list-row-container,.grid-row,
.page-title,.frappe-card,.frappe-card *,.breadcrumb,.breadcrumb-item {
  font-family:var(--font-family) !important;
  font-size:inherit !important;
  line-height:inherit !important;
}

/* Заголовки */
h1{font-size:calc(var(--base-font-size)*1.90) !important;line-height:1.25 !important}
h2{font-size:calc(var(--base-font-size)*1.60) !important;line-height:1.28 !important}
h3{font-size:calc(var(--base-font-size)*1.35) !important;line-height:1.30 !important}
h4{font-size:calc(var(--base-font-size)*1.20) !important;line-height:1.33 !important}
h5{font-size:calc(var(--base-font-size)*1.10) !important;line-height:1.35 !important}
h6{font-size:calc(var(--base-font-size)*1.00) !important;line-height:1.40 !important}

/* Сайдбар названия и пункты */
.workspace-sidebar .sidebar-title,
.workspace-sidebar .sidebar-label,
.standard-sidebar .sidebar-title,
.sidebar-section .section-title,
.sidebar .sidebar-label,.sidebar .section-title,.sidebar .sidebar-title,
.module-sidebar .sidebar-title,
.standard-sidebar .sidebar-section .section-title,
.standard-sidebar .sidebar-item .item-anchor .sidebar-item-label{
  font-family:var(--font-family) !important;
  font-size:var(--base-font-size) !important;
  line-height:var(--line-height-base) !important;
  font-weight:600 !important;
}
.sidebar .sidebar-menu .sidebar-item .item-anchor,
.sidebar .sidebar-item .item-anchor,.sidebar .sidebar-item .item-anchor .label,
.sidebar .sidebar-item .item-anchor span{
  font-family:var(--font-family) !important;
  font-size:inherit !important;
  line-height:var(--line-height-base) !important;
}

/* Табы/вкладки слегка компактнее */
.nav-tabs .nav-link,.nav-pills .nav-link,.form-tabs .nav-tabs .nav-link,.form-tabs .nav-item .nav-link{
  font-size:calc(var(--base-font-size)*0.95) !important;
}

/* Кнопки/бейджи — тоже компактнее */
.btn,.dropdown-item,.badge,.indicator,.pagination,.page-link{
  font-size:calc(var(--base-font-size)*0.95) !important;
}

/* Плейсхолдеры */
::placeholder{font-size:inherit !important}
`;

  function inject() {
    const id = 'dantist-typography-inject';
    if (document.getElementById(id)) return;
    const s = document.createElement('style');
    s.id = id;
    s.type = 'text/css';
    s.appendChild(document.createTextNode(CSS));
    document.head.appendChild(s);
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', inject, { once: true });
  } else {
    inject();
  }

  // Перестраховка на переходах внутри Desk
  frappe?.router?.on?.('change', () => setTimeout(inject, 0));
  frappe?.after_ajax && frappe.after_ajax(() => setTimeout(inject, 0));
})();
