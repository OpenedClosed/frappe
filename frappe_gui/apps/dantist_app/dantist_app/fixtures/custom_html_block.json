[
 {
  "docstatus": 0,
  "doctype": "Custom HTML Block",
  "html": "<!-- ==== KB embed: rounded iframe & rounded error image ==== -->\n<div id=\"kb-shell\" style=\"\n  width:100%;\n  height:700px;\n  position:relative;\n  border-radius:16px;        /* –º–∞—Å–∫–∞ —Å–∫—Ä—É–≥–ª–µ–Ω–∏—è */\n  overflow:hidden;           /* –∫–ª–∏–ø –ø–æ —Ä–∞–¥–∏—É—Å—É */\n  background:transparent;    /* —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –±–µ–ª–æ–≥–æ –ø–æ–¥–ª–æ–∂–∫–∏ */\n\">\n  <iframe id=\"kb-frame\" title=\"Knowledge Base\" style=\"\n    display:block;\n    width:100%; height:100%;\n    border:0;\n    border-radius:inherit !important;  /* –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ */\n  \"></iframe>\n\n  <!-- –ü–æ—è–≤–ª—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –ø—Ä–∏ init/load/network error -->\n  <img id=\"kb-error-img\" src=\"/assets/dantist_app/files/error.png\" alt=\"Error\" style=\"\n    display:none;\n    width:100%; height:100%;\n    object-fit:contain; object-position:center;\n    border-radius:inherit !important;  /* –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ */\n    background:transparent;\n  \" loading=\"lazy\" />\n</div>\n\n<!-- –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–æ, –Ω–∏–∂–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –ø–æ–∫–∞–∂–µ–º) -->\n<div id=\"kb-error-text\" style=\"\n  display:none; margin-top:10px;\n  padding:10px 12px; border-radius:12px;\n  background:#fff; box-shadow:0 2px 10px rgba(0,0,0,.06);\n  color:#333; font-size:14px; line-height:1.5;\n  white-space:pre-wrap; word-break:break-word;\n\"></div>\n",
  "modified": "2025-10-14 20:28:31.727367",
  "name": "Knowledge Base IFrame",
  "private": 0,
  "roles": [],
  "script": "(function () {\n  const IFRAME_PATH = \"/admin/knowledge-base-embeded\"; // –ø—É—Ç—å —Ñ—Ä–æ–Ω—Ç–∞ –ë–ó\n  const PROBE_TIMEOUT_MS = 7000;\n  const DEBUG = true;\n\n  let step = 0;\n  const tag = \"[KB-embed]\";\n  const now = () => new Date().toISOString();\n  const log  = (...a) => DEBUG && console.log(tag, (++step), now(), ...a);\n\n  // --- –ø–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å —É—á—ë—Ç–æ–º shadow DOM ---\n  function find_in_tree(root_node, id) {\n    if (root_node && typeof root_node.getElementById === \"function\") {\n      const hit = root_node.getElementById(id); if (hit) return hit;\n    }\n    if (root_node && root_node.querySelector) {\n      try { const hit = root_node.querySelector(`#${CSS.escape(id)}`); if (hit) return hit; } catch {}\n    }\n    const root_el = (root_node instanceof Document ? root_node.documentElement : root_node);\n    const walker = document.createTreeWalker(root_el, NodeFilter.SHOW_ELEMENT, null);\n    let node = walker.currentNode;\n    while (node) {\n      if (node.shadowRoot) {\n        const hit = find_in_tree(node.shadowRoot, id);\n        if (hit) return hit;\n      }\n      node = walker.nextNode();\n    }\n    return null;\n  }\n  function wait_for_elements(ids, on_ready) {\n    const try_get = () => {\n      const got = {}; let all = true;\n      for (const id of ids) {\n        const el = find_in_tree(document, id);\n        got[id] = el; if (!el) all = false;\n      }\n      log(\"probe elements:\", Object.fromEntries(Object.entries(got).map(([k,v]) => [k, !!v])));\n      if (all) { obs.disconnect(); on_ready(got); }\n    };\n    const obs = new MutationObserver(() => try_get());\n    obs.observe(document.documentElement || document, { childList: true, subtree: true });\n    try_get();\n  }\n\n  // --- UI helpers ---\n  function show_iframe(iframe, img) {\n    img.style.display = \"none\";\n    iframe.style.display = \"block\";\n  }\n  function show_error_image(iframe, img, reason, error_box, text) {\n    try { iframe.removeAttribute(\"src\"); } catch {}\n    iframe.style.display = \"none\";\n    img.style.borderRadius = \"16px\";\n    img.style.display = \"block\";\n    if (error_box && text) { error_box.textContent = text; error_box.style.display = \"block\"; }\n  }\n\n  // --- –±—ã—Å—Ç—Ä–∞—è —Å–µ—Ç. –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ CORS ---\n  async function probe_reachability(url) {\n    const ctrl = new AbortController();\n    const to = setTimeout(() => ctrl.abort(), PROBE_TIMEOUT_MS);\n    try {\n      const res = await fetch(url, { method: \"GET\", mode: \"no-cors\", signal: ctrl.signal });\n      clearTimeout(to);\n      return { reachable: true, type: res.type };\n    } catch (e) {\n      clearTimeout(to);\n      return { reachable: false, error: e?.name || String(e) };\n    }\n  }\n\n  // --- Frappe RPC ---\n  function call_whitelist(method, args = {}) {\n    return new Promise((resolve, reject) => {\n      frappe.call({\n        method,\n        type: \"POST\",\n        args,\n        async: true,\n        callback: (r) => resolve(r?.message || r),\n        error: (xhr) => reject(new Error(xhr?.responseText || \"RPC error\"))\n      });\n    });\n  }\n\n  // --- ensure_token: link_check -> get_token (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ) ---\n  async function ensure_token() {\n    const check = await call_whitelist(\"dantist_app.api.auth.handlers.link_check\");\n    if (check?.ok) return true;\n    const got = await call_whitelist(\"dantist_app.api.auth.handlers.get_token\");\n    if (!got?.ok) throw new Error(\"Token fetch failed\");\n    const recheck = await call_whitelist(\"dantist_app.api.auth.handlers.link_check\");\n    return !!recheck?.ok;\n  }\n\n  // --- main ---\n  wait_for_elements([\"kb-frame\", \"kb-error-img\", \"kb-error-text\"], async ({ \"kb-frame\": iframe, \"kb-error-img\": img, \"kb-error-text\": err_box }) => {\n    log(\"init\");\n\n    // 0) origin —Ñ—Ä–æ–Ω—Ç–∞\n    let origin;\n    try {\n      const o = await call_whitelist(\"dantist_app.api.auth.handlers.get_iframe_origin\");\n      if (!o?.ok || !o?.origin) throw new Error(\"No origin\");\n      origin = o.origin.replace(/\\/$/, \"\");\n    } catch (_) {\n      show_error_image(iframe, img, \"origin fetch failed\", err_box, \"Failed to get iframe origin.\");\n      return;\n    }\n\n    // 1) –≤–∞–ª–∏–¥–Ω–∞—è –∫—É–∫–∞ access_token\n    try {\n      const ok = await ensure_token();\n      if (!ok) throw new Error(\"Token not ready\");\n    } catch (_) {\n      show_error_image(iframe, img, \"token ensure failed\", err_box, \"Authorization failed.\");\n      return;\n    }\n\n    // 2) reachability\n    const url = `${origin}${IFRAME_PATH}`;\n    const pr = await probe_reachability(url);\n    if (!pr.reachable) {\n      show_error_image(iframe, img, \"network unreachable\", err_box, \"Connection failed: server is unreachable.\");\n      return;\n    }\n\n    // 3) –≥—Ä—É–∑–∏–º iFrame\n    try {\n      iframe.addEventListener(\"load\", () => show_iframe(iframe, img), { once: true });\n      iframe.addEventListener(\"error\", () => show_error_image(iframe, img, \"iframe error\", err_box, \"Failed to load the embedded page.\"), { once: true });\n      iframe.src = url;\n      show_iframe(iframe, img);\n    } catch (e) {\n      show_error_image(iframe, img, \"setting src exception\", err_box, e?.message || \"Initialization error\");\n    }\n\n    // –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ postMessage (–ø–æ –∂–µ–ª–∞–Ω–∏—é)\n    window.addEventListener(\"message\", (e) => {\n      // if (e.origin !== origin) return;\n      log(\"postMessage:\", { origin: e.origin, data: e.data });\n    });\n  });\n})();\n",
  "style": ""
 },
 {
  "docstatus": 0,
  "doctype": "Custom HTML Block",
  "html": "<!-- ==== KB embed: rounded iframe & rounded error image ==== -->\n<div id=\"kb-shell\" style=\"\n  width:100%;\n  height:700px;\n  position:relative;\n  border-radius:16px;        /* –º–∞—Å–∫–∞ —Å–∫—Ä—É–≥–ª–µ–Ω–∏—è */\n  overflow:hidden;           /* –∫–ª–∏–ø –ø–æ —Ä–∞–¥–∏—É—Å—É */\n  background:transparent;    /* —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –±–µ–ª–æ–≥–æ –ø–æ–¥–ª–æ–∂–∫–∏ */\n\">  \n  <iframe id=\"kb-frame\" title=\"Knowledge Base\" style=\"\n    display:block;\n    width:100%; height:100%;\n    border:0;\n    border-radius:inherit !important;  /* –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ */\n  \"></iframe>\n\n  <!-- –ü–æ—è–≤–ª—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –ø—Ä–∏ init/load/network error -->\n  <img id=\"kb-error-img\" src=\"/assets/dantist_app/files/error.png\" alt=\"Error\" style=\"\n    display:none;\n    width:100%; height:100%;\n    object-fit:contain; object-position:center;\n    border-radius:inherit !important;  /* –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ */\n    background:transparent;\n  \" loading=\"lazy\" /> \n</div>\n \n<!-- –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–æ, –Ω–∏–∂–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –ø–æ–∫–∞–∂–µ–º) -->\n<div id=\"kb-error-text\" style=\"\n  display:none; margin-top:10px;\n  padding:10px 12px; border-radius:12px;\n  background:#fff; box-shadow:0 2px 10px rgba(0,0,0,.06);\n  color:#333; font-size:14px; line-height:1.5;\n  white-space:pre-wrap; word-break:break-word;\n\"></div>\n",
  "modified": "2025-10-14 20:36:22.539904",
  "name": "Chat Sessions IFrame",
  "private": 0,
  "roles": [],
  "script": "(function () {\n  const IFRAME_PATH = \"/admin/chat-sessions-embeded\"; // –ø—É—Ç—å —Ç–≤–æ–µ–≥–æ —Ñ—Ä–æ–Ω—Ç–∞ –≤ iFrame\n  const PROBE_TIMEOUT_MS = 7000;\n  const DEBUG = true;\n\n  let step = 0;\n  const tag = \"[KB-embed]\";\n  const now = () => new Date().toISOString();\n  const log  = (...a) => DEBUG && console.log(tag, (++step), now(), ...a);\n  const warn = (...a) => DEBUG && console.warn(tag, (++step), now(), ...a);\n\n  function find_in_tree(root_node, id) {\n    if (root_node && typeof root_node.getElementById === \"function\") {\n      const hit = root_node.getElementById(id); if (hit) return hit;\n    }\n    if (root_node && root_node.querySelector) {\n      try { const hit = root_node.querySelector(`#${CSS.escape(id)}`); if (hit) return hit; } catch {}\n    }\n    const root_el = (root_node instanceof Document ? root_node.documentElement : root_node);\n    const walker = document.createTreeWalker(root_el, NodeFilter.SHOW_ELEMENT, null);\n    let node = walker.currentNode;\n    while (node) {\n      if (node.shadowRoot) {\n        const hit = find_in_tree(node.shadowRoot, id);\n        if (hit) return hit;\n      }\n      node = walker.nextNode();\n    }\n    return null;\n  }\n\n  function wait_for_elements(ids, on_ready) {\n    const try_get = () => {\n      const got = {};\n      let all = true;\n      for (const id of ids) {\n        const el = find_in_tree(document, id);\n        got[id] = el; if (!el) all = false;\n      }\n      log(\"probe elements:\", Object.fromEntries(Object.entries(got).map(([k,v]) => [k, !!v])));\n      if (all) { obs.disconnect(); on_ready(got); }\n    };\n    const obs = new MutationObserver(() => try_get());\n    obs.observe(document.documentElement || document, { childList: true, subtree: true });\n    try_get();\n  }\n \n  function show_iframe(iframe, img) {\n    img.style.display = \"none\";\n    iframe.style.display = \"block\";\n  }  \n  function show_error_image(iframe, img, reason, error_box, text) {\n    try { iframe.removeAttribute(\"src\"); } catch {}\n    iframe.style.display = \"none\";\n    img.style.borderRadius = \"16px\";\n    img.style.display = \"block\";\n    if (error_box && text) {\n      error_box.textContent = text;\n      error_box.style.display = \"block\";\n    }\n  }\n\n  async function probe_reachability(url) {\n    const ctrl = new AbortController();\n    const to = setTimeout(() => ctrl.abort(), PROBE_TIMEOUT_MS);\n    try {\n      const res = await fetch(url, { method: \"GET\", mode: \"no-cors\", signal: ctrl.signal });\n      clearTimeout(to);\n      return { reachable: true, type: res.type };\n    } catch (e) {\n      clearTimeout(to);\n      return { reachable: false, error: e?.name || String(e) };\n    }\n  }\n\n  function call_whitelist(method, args = {}) {\n    return new Promise((resolve, reject) => {\n      frappe.call({\n        method,\n        type: \"POST\",\n        args,\n        async: true,\n        callback: (r) => resolve(r?.message || r),\n        error: (xhr) => reject(new Error(xhr?.responseText || \"RPC error\"))\n      });\n    });\n  }\n \n  async function ensure_token() {\n    // 1) –ï—Å—Ç—å –ª–∏ –≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –∫—É–∫–µ?\n    const check = await call_whitelist(\"dantist_app.api.auth.handlers.link_check\");\n    if (check?.ok) return true;\n\n    // 2) –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –∑–∞–ø—Ä–æ—Å–∏–º –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω (Frappe –ø—Ä–æ—Å—Ç–∞–≤–∏—Ç Set-Cookie –∫–ª–∏–µ–Ω—Ç—É)\n    const got = await call_whitelist(\"dantist_app.api.auth.handlers.get_token\");\n    if (!got?.ok) throw new Error(\"Token fetch failed\");\n\n    // 3) –ë—ã—Å—Ç—Ä—ã–π –ø–æ–≤—Ç–æ—Ä–Ω—ã–π check (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –Ω–æ –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏)\n    const recheck = await call_whitelist(\"dantist_app.api.auth.handlers.link_check\");\n    return !!recheck?.ok;\n  }\n\n  wait_for_elements([\"kb-frame\", \"kb-error-img\", \"kb-error-text\"], async ({ \"kb-frame\": iframe, \"kb-error-img\": img, \"kb-error-text\": err_box }) => {\n    log(\"init\");\n\n    // 0) –£–∑–Ω–∞—ë–º origin —Ñ—Ä–æ–Ω—Ç–∞\n    let origin;\n    try {\n      const o = await call_whitelist(\"dantist_app.api.auth.handlers.get_iframe_origin\");\n      if (!o?.ok || !o?.origin) throw new Error(\"No origin\");\n      origin = o.origin.replace(/\\/$/, \"\");\n    } catch (_) {\n      show_error_image(iframe, img, \"origin fetch failed\", err_box, \"Failed to get iframe origin.\");\n      return;\n    }\n\n    // 1) –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –Ω–∞–ª–∏—á–∏–µ –≤–∞–ª–∏–¥–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –≤ cookie\n    try {\n      const ok = await ensure_token();\n      if (!ok) throw new Error(\"Token not ready\");\n    } catch (_) {\n      show_error_image(iframe, img, \"token ensure failed\", err_box, \"Authorization failed.\");\n      return;\n    }\n\n    // 2) –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ñ—Ä–æ–Ω—Ç–∞\n    const url = `${origin}${IFRAME_PATH}`;\n    const pr = await probe_reachability(url);\n    if (!pr.reachable) {\n      show_error_image(iframe, img, \"network unreachable\", err_box, \"Connection failed: server is unreachable.\");\n      return;\n    }\n\n    // 3) –ì—Ä—É–∑–∏–º iFrame\n    try {\n      iframe.addEventListener(\"load\", () => show_iframe(iframe, img), { once: true });\n      iframe.addEventListener(\"error\", () => show_error_image(iframe, img, \"iframe error\", err_box, \"Failed to load the embedded page.\"), { once: true });\n      iframe.src = url;\n      show_iframe(iframe, img);\n    } catch (e) {\n      show_error_image(iframe, img, \"setting src exception\", err_box, e?.message || \"Initialization error\");\n    }\n\n    // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –ª–æ–≥ –ø–æ—á—Ç—ã –∏–∑ iFrame\n    window.addEventListener(\"message\", (e) => {\n      // if (e.origin !== origin) return;\n      log(\"postMessage:\", { origin: e.origin, data: e.data });\n    });\n  });\n})();\n",
  "style": null
 },
 {
  "docstatus": 0,
  "doctype": "Custom HTML Block",
  "html": "<!-- ==== AIHub banner (image only) ==== -->\n<div style=\"max-width: 980px; margin: 0 auto;\">\n  <div style=\"\n    text-align: center;\n    overflow: hidden;\n    border-radius: 20px;\n    height: 360px;\n    box-shadow: 0 8px 28px rgba(0,0,0,.08);\n  \">\n    <img\n      src=\"/assets/dantist_app/files/home-page.png\"\n      alt=\"AIHub ‚Äî Home\"\n      style=\"width: 100%; height: 100%; object-fit: cover; object-position: center;\"\n      loading=\"lazy\"\n    />\n  </div>\n</div>\n<!-- ==== /AIHub banner ==== -->\n",
  "modified": "2025-10-02 17:00:08.937807",
  "name": "Home Page Main",
  "private": 0,
  "roles": [],
  "script": null,
  "style": null
 },
 {
  "docstatus": 0,
  "doctype": "Custom HTML Block",
  "html": "<!-- Dentist ‚Ä¢ Bot Setup Teaser -->\n<section class=\"bot-teaser-root\">\n  <div class=\"bot-teaser\"></div>\n</section>",
  "modified": "2025-10-23 22:41:00.402737",
  "name": "Bot Settings Page",
  "private": 0,
  "roles": [],
  "script": "// Dentist ‚Ä¢ Bot Setup Teaser ‚Äî theme-safe + instant repaint + i18n\n(function (root) {\n  if (!root) return;\n\n  // --- utils ----------------------------------------------------\n  var esc = (window.frappe && frappe.utils && frappe.utils.escape_html) ? frappe.utils.escape_html : (s)=>String(s);\n\n  function safe(obj, path, dflt){ dflt = dflt===void 0 ? \"\" : dflt;\n    try{ var cur=obj, parts=path.split(\".\"); for(var i=0;i<parts.length;i++){ if(cur==null) return dflt; cur=cur[parts[i]]; }\n      return (cur===undefined||cur===null) ? dflt : cur;\n    } catch(e){ return dflt; }\n  }\n\n  function readCookie(name){\n    var m = document.cookie.match(new RegExp(\"(?:^|;\\\\s*)\" + name + \"=([^;]+)\"));\n    return m ? decodeURIComponent(m[1]) : \"\";\n  }\n\n  function mapCode(s){\n    var v = String(s || \"\").toLowerCase();\n    if (v.indexOf(\"ru\")===0) return \"ru\";\n    if (v.indexOf(\"uk\")===0 || v.indexOf(\"ua\")===0) return \"uk\";\n    if (v.indexOf(\"pl\")===0) return \"pl\";\n    if (v.indexOf(\"ka\")===0 || v.indexOf(\"geor\")>-1) return \"ka\";\n    if (v.indexOf(\"be\")===0) return \"be\";\n    return \"en\";\n  }\n\n  function pickLang(){\n    var fb   = window.frappe || {};\n    var boot = fb.boot || {};\n    var usr  = boot.user || {};\n    var defs = usr.defaults || usr.user_defaults || {};\n    var pool = [\n      { src: \"user.language\",              code: usr.language || \"\" },\n      { src: \"user.user_language\",         code: usr.user_language || \"\" },\n      { src: \"user.defaults.language\",     code: defs.language || \"\" },\n      { src: \"user.defaults.lang\",         code: defs.lang || \"\" },\n      { src: \"cookie.preferred_language\",  code: readCookie(\"preferred_language\") },\n      { src: \"cookie.lang\",                code: readCookie(\"lang\") },\n      { src: \"boot.lang\",                  code: boot.lang || \"\" },\n      { src: \"sysdefaults.language\",       code: safe(boot, \"sysdefaults.language\", \"\") },\n      { src: \"navigator.languages[0]\",     code: (navigator.languages && navigator.languages[0]) || \"\" },\n      { src: \"navigator.language\",         code: navigator.language || \"\" }\n    ];\n    var chosen = \"en\", chosenSrc = \"fallback.en\";\n    for (var i=0;i<pool.length;i++){\n      var raw = String(pool[i].code || \"\").trim();\n      if (!raw) continue;\n      chosen = mapCode(raw); chosenSrc = pool[i].src; break;\n    }\n    try{ console.groupCollapsed(\"[Bot Teaser] i18n\"); console.table(pool.map(function(x){return {source:x.src, raw:x.code, mapped:x.code?mapCode(x.code):\"\"};})); console.info(\"chosen:\",chosen,\"from:\",chosenSrc); console.groupEnd(); }catch(_){}\n    return chosen;\n  }\n\n  // host for ShadowRoot or element itself\n  function getHost(){\n    return (root && root.host && root.host.setAttribute) ? root.host : (root.setAttribute ? root : null);\n  }\n\n  function mirrorThemeTag() {\n    var tag = (document.documentElement.getAttribute('data-theme') || 'light').toLowerCase();\n    var host = getHost();\n    if (host) host.setAttribute('data-theme', tag);\n    var card = root.querySelector('.bot-teaser-root');\n    if (card && card.setAttribute) card.setAttribute('data-theme', tag);\n  }\n\n  // --- i18n strings --------------------------------------------\n  var M = {\n    en: {\n      title: \"ü§ñ Create your bot in two clicks\",\n      p1: \"Pick a name, upload an avatar, choose tone ‚Äî done.<br>Need more control? Fine-tune behavior and messages anytime.<br>The most recently created bot is prioritized automatically.\",\n      alt: \"Bot settings overview\"\n    },\n    ru: {\n      title: \"ü§ñ –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ –≤ –¥–≤–∞ –∫–ª–∏–∫–∞\",\n      p1: \"–í—ã–±–µ—Ä–∏—Ç–µ –∏–º—è, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä, —É–∫–∞–∂–∏—Ç–µ —Ç–æ–Ω ‚Äî –≥–æ—Ç–æ–≤–æ.<br>–ù—É–∂–µ–Ω –±–æ–ª—å—à–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å? –¢–æ–Ω–∫–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç.<br>–°–∞–º—ã–π –Ω–µ–¥–∞–≤–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç.\",\n      alt: \"–û–±–∑–æ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–æ—Ç–∞\"\n    },\n    uk: {\n      title: \"ü§ñ –°—Ç–≤–æ—Ä—ñ—Ç—å –±–æ—Ç–∞ –∑–∞ –¥–≤–∞ –∫–ª—ñ–∫–∏\",\n      p1: \"–í–∏–±–µ—Ä—ñ—Ç—å —ñ–º º—è, –¥–æ–¥–∞–π—Ç–µ –∞–≤–∞—Ç–∞—Ä, –∑–∞–¥–∞–π—Ç–µ —Ç–æ–Ω ‚Äî –≥–æ—Ç–æ–≤–æ.<br>–ü–æ—Ç—Ä—ñ–±–Ω–æ –±—ñ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—é? –¢–æ—á–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤—É–π—Ç–µ –ø–æ–≤–µ–¥—ñ–Ω–∫—É —Ç–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±—É–¥—å-–∫–æ–ª–∏.<br>–ù–∞–π–Ω–æ–≤—ñ—à–∏–π –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –º–∞—î –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç.\",\n      alt: \"–û–≥–ª—è–¥ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –±–æ—Ç–∞\"\n    },\n    pl: {\n      title: \"ü§ñ Utw√≥rz bota w dw√≥ch klikniƒôciach\",\n      p1: \"Wybierz nazwƒô, dodaj awatar, ustaw ton ‚Äî gotowe.<br>Chcesz wiƒôcej kontroli? Dopracuj zachowanie i wiadomo≈õci w dowolnym momencie.<br>Najnowszy bot jest automatycznie priorytetyzowany.\",\n      alt: \"PrzeglƒÖd ustawie≈Ñ bota\"\n    },\n    ka: {\n      title: \"ü§ñ ·É®·Éî·É•·Éõ·Éî·Éú·Éò·Éó ·Éë·Éù·É¢·Éò ·Éù·É† ·Éõ·Éù·É•·Éõ·Éî·Éì·Éî·Éë·Éê·É®·Éò\",\n      p1: \"·Éê·Éò·É†·É©·Éò·Éî·Éó ·É°·Éê·ÉÆ·Éî·Éö·Éò, ·Éê·É¢·Éï·Éò·É†·Éó·Éî·Éó ·Éê·Éï·Éê·É¢·Éê·É†·Éò, ·Éõ·Éò·É£·Éó·Éò·Éó·Éî·Éó ·É¢·Éù·Éú·Éò ‚Äî ·Éõ·Éñ·Éê·Éì·Éê·Éê.<br>·Éõ·Éî·É¢·Éò ·Éô·Éù·Éú·É¢·É†·Éù·Éö·Éò ·Éí·Éò·Éú·Éì·Éê·Éó? ·Éì·Éê·Éê·É†·Éî·Éí·É£·Éö·Éò·É†·Éî·Éó ·É•·É™·Éî·Éï·Éê ·Éì·Éê ·É®·Éî·É¢·Éß·Éù·Éë·Éò·Éú·Éî·Éë·Éî·Éë·Éò ·Éú·Éî·Éë·Éò·É°·Éõ·Éò·Éî·É† ·Éì·É†·Éù·É°.<br>·É£·Éê·ÉÆ·Éö·Éî·É°·Éê·Éì ·É®·Éî·É•·Éõ·Éú·Éò·Éö·Éò ·Éë·Éù·É¢·Éò ·Éê·Éï·É¢·Éù·Éõ·Éê·É¢·É£·É†·Éê·Éì ·ÉÆ·Éì·Éî·Éë·Éê ·Éû·É†·Éò·Éù·É†·Éò·É¢·Éî·É¢·É£·Éö·Éò.\",\n      alt: \"·Éë·Éù·É¢·Éò·É° ·Éû·Éê·É†·Éê·Éõ·Éî·É¢·É†·Éî·Éë·Éò·É° ·Éõ·Éò·Éõ·Éù·ÉÆ·Éò·Éö·Éï·Éê\"\n    },\n    be: {\n      title: \"ü§ñ –°—Ç–≤–∞—Ä—ã—Ü–µ –±–æ—Ç–∞ —û –¥–≤–∞ –∫–ª—ñ–∫—ñ\",\n      p1: \"–ê–±—è—Ä—ã—Ü–µ –Ω–∞–∑–≤—É, –∑–∞–≥—Ä—É–∑—ñ—Ü–µ –∞–≤–∞—Ç–∞—Ä, —É–∫–∞–∂—ã—Ü–µ —Ç–æ–Ω ‚Äî –≥–∞—Ç–æ–≤–∞.<br>–ü–∞—Ç—Ä—ç–±–Ω–∞ –±–æ–ª—å—à –∫–∞–Ω—Ç—Ä–æ–ª—é? –î–∞–∫–ª–∞–¥–Ω–∞ –Ω–∞–ª–∞–¥–∂–≤–∞–π—Ü–µ –ø–∞–≤–æ–¥–∑—ñ–Ω—ã —ñ –ø–∞–≤–µ–¥–∞–º–ª–µ–Ω–Ω—ñ —û –ª—é–±—ã –º–æ–º–∞–Ω—Ç.<br>–ù–∞–π–Ω–æ—û—à—ã –±–æ—Ç –∞—û—Ç–∞–º–∞—Ç—ã—á–Ω–∞ –∞—Ç—Ä—ã–º–ª—ñ–≤–∞–µ –ø—Ä—ã—è—Ä—ã—Ç—ç—Ç.\",\n      alt: \"–ê–≥–ª—è–¥ –Ω–∞–ª–∞–¥ –±–æ—Ç–∞\"\n    }\n  };\n\n  // --- render ---------------------------------------------------\n  function render(lang){\n    var T = M[lang] || M.en;\n\n    var host = root.querySelector(\".bot-teaser\");\n    if (!host) {\n      host = document.createElement(\"div\");\n      host.className = \"bot-teaser\";\n      var wrap = root.querySelector(\".bot-teaser-root\");\n      (wrap || root).appendChild(host);\n    }\n\n    var left  = document.createElement(\"div\");\n    left.className = \"bot-teaser__left\";\n\n    var media = document.createElement(\"div\");\n    media.className = \"bot-teaser__media\";\n\n    var img = document.createElement(\"img\");\n    img.src = \"/assets/dantist_app/files/bot-settings.png\";\n    img.alt = esc(T.alt);\n    img.loading = \"lazy\";\n\n    media.appendChild(img);\n    left.appendChild(media);\n\n    var right = document.createElement(\"div\");\n    right.className = \"bot-teaser__right\";\n\n    var h = document.createElement(\"h3\");\n    h.className = \"bot-teaser__title\";\n    h.innerHTML = T.title;\n\n    var p = document.createElement(\"p\");\n    p.className = \"bot-teaser__text\";\n    p.innerHTML = T.p1;\n\n    right.appendChild(h);\n    right.appendChild(p);\n\n    host.innerHTML = \"\";\n    host.appendChild(left);\n    host.appendChild(right);\n  }\n\n  // --- theme sync (instant repaint) -----------------------------\n  mirrorThemeTag();\n  try {\n    new MutationObserver(function(){\n      mirrorThemeTag();\n      // repaint not strictly needed (CSS vars), –Ω–æ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π:\n      // –∑–¥–µ—Å—å –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∞ –Ω–µ –¥–µ–ª–∞–µ–º, —á—Ç–æ–±—ã –Ω–µ –º–∏–≥–∞–ª–æ\n    }).observe(document.documentElement, { attributes: true, attributeFilter: ['data-theme'] });\n  } catch(_){}\n\n  // --- init -----------------------------------------------------\n  try { render(pickLang()); } catch(e){ try{ console.error(\"[Bot Teaser] render error:\", e); }catch(_){ } }\n\n})(root_element);",
  "style": "/* Dentist ‚Ä¢ Bot Setup Teaser ‚Äî neutral, responsive, theme-aware */\n.bot-teaser-root {\n  max-width: 980px;\n  margin: 0 auto;\n  padding: 16px;\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto,\n               \"Helvetica Neue\", Arial, sans-serif;\n  line-height: 1.6;\n  font-size: 16px;\n  /* —á–∏—Ç–∞–µ–º —Ü–≤–µ—Ç–∞ –∏–∑ —Ç–µ–º—ã: —á—Ç–æ–±—ã —Å—Ä–∞–∑—É –æ–±–Ω–æ–≤–ª—è–ª–æ—Å—å –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç–µ–º—ã */\n  color: var(--text-color, #111827);\n}\n\n.bot-teaser {\n  display: flex;\n  gap: 16px;\n  align-items: center;\n  flex-wrap: wrap;\n  border: 1px solid var(--border-color, #e5e7eb);\n  border-radius: 12px;\n  padding: 16px;\n  box-shadow: var(--shadow-base, 0 4px 16px rgba(0,0,0,.05));\n  background: var(--card-bg, #fff);\n  transition: background .15s ease, border-color .15s ease, box-shadow .15s ease, color .15s ease;\n}\n\n.bot-teaser__left {\n  flex: 0 0 220px;\n  max-width: 220px;\n  width: 100%;\n}\n\n.bot-teaser__media {\n  border-radius: 12px;\n  overflow: hidden;\n  background: var(--control-bg, #f8fafc);\n  position: relative;\n}\n.bot-teaser__media::before {\n  content: \"\";\n  display: block;\n  width: 100%;\n  padding-bottom: 75%; /* 4:3 aspect */\n}\n.bot-teaser__media img {\n  position: absolute;\n  inset: 0;\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  object-position: center;\n}\n\n.bot-teaser__right {\n  flex: 1 1 320px;\n  min-width: 260px;\n}\n\n.bot-teaser__title {\n  margin: 0 0 8px;\n  font-weight: 600;\n  color: var(--text-color, #111827);\n}\n\n.bot-teaser__text {\n  margin: 0;\n  color: var(--text-muted, #6b7280);\n}\n\n/* –ù–µ–±–æ–ª—å—à–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –Ω–∞ —É–∑–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */\n@media (max-width: 520px) {\n  .bot-teaser__left { flex-basis: 100%; max-width: 100%; }\n}"
 },
 {
  "docstatus": 0,
  "doctype": "Custom HTML Block",
  "html": "<div class=\"crm-card\" data-widget=\"crm-kanban-tabs\">\n  <div class=\"crm-card__header\"> \n    <div class=\"crm-card__title\">\n      <i class=\"crm-ico crm-ico-kanban\"></i>\n      <div>\n        <div class=\"t\">Engagement Boards</div>\n        <div class=\"s\">Quick overview & jump</div>\n      </div>\n    </div>\n\n    <div class=\"crm-card__actions\">\n      <div class=\"crm-actions-grid\">\n        <!-- –†—è–¥ 1: –¥–µ–π—Å—Ç–≤–∏—è –ø–æ –∞–∫—Ç–∏–≤–Ω–æ–π –¥–æ—Å–∫–µ -->\n        <div class=\"crm-actions -board\">\n          <div class=\"crm-actions__label\">This board</div>\n          <button class=\"btn btn-sm btn-default\" data-action=\"open-board-list\">\n            <i class=\"crm-ico crm-ico-list\"></i><span>Board List</span>\n          </button>\n          <button class=\"btn btn-sm btn-default\" data-action=\"open-board-kanban\">\n            <i class=\"crm-ico crm-ico-kanban\"></i><span>Board Kanban</span>\n          </button>\n          <button class=\"btn btn-sm btn-primary\" data-action=\"new-in-active\">\n            <i class=\"crm-ico crm-ico-plus\"></i>\n            <span>Add to <span data-role=\"active-label\">Leads</span></span>\n          </button>\n        </div>\n\n        <!-- –†—è–¥ 2: –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->\n        <div class=\"crm-actions -global\">\n          <div class=\"crm-actions__label\">Global</div>\n          <button class=\"btn btn-sm btn-default\" data-action=\"open-all-list\">\n            <i class=\"crm-ico crm-ico-boards\"></i><span>All Cases</span>\n          </button>\n          <button class=\"btn btn-sm btn-default\" data-action=\"new-case\">\n            <i class=\"crm-ico crm-ico-plus\"></i><span>New Case</span>\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"crm-tabs\">\n    <!-- <button class=\"crm-tab\" data-board=\"CRM Board\">CRM</button> -->\n    <button class=\"crm-tab -active\" data-board=\"Leads ‚Äì Contact Center\">Leads</button>\n    <button class=\"crm-tab\" data-board=\"Deals ‚Äì Contact Center\">Deals</button>\n    <button class=\"crm-tab\" data-board=\"Patients ‚Äì Care Department\">Patients</button>\n  </div>\n\n  <div class=\"crm-metrics\"></div>\n  <div class=\"crm-list\" data-region=\"preview\"></div>\n</div>",
  "modified": "2025-11-10 17:39:54.813088",
  "name": "CRM Board",
  "private": 0,
  "roles": [],
  "script": "// CRM widget ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π ShadowRoot\n// –í–∫–ª–∞–¥–∫–∏, –º–µ—Ç—Ä–∏–∫–∏, –ø—Ä–µ–≤—å—é. –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã.\n\n(async function (root) {\n  if (!root) { console.warn(\"[CRM Tabs] no root_element\"); return; }\n\n  // --- helpers (safe –¥–ª—è ShadowRoot) ---\n  const getHost = () => (root && root.host && root.host.setAttribute ? root.host : (root.setAttribute ? root : null));\n  const q  = (sel, el=root) => (el && el.querySelector) ? el.querySelector(sel) : null;\n  const qq = (sel, el=root) => (el && el.querySelectorAll) ? Array.from(el.querySelectorAll(sel)) : [];\n\n  const DOCTYPE = \"Engagement Case\";\n  const esc = (frappe && frappe.utils && frappe.utils.escape_html) ? frappe.utils.escape_html : (s => String(s));\n\n  const BOARD_META = {\n    \"CRM Board\":                   { flag: \"show_board_crm\",      status_field: \"status_crm_board\" },\n    \"Leads ‚Äì Contact Center\":      { flag: \"show_board_leads\",    status_field: \"status_leads\" },\n    \"Deals ‚Äì Contact Center\":      { flag: \"show_board_deals\",    status_field: \"status_deals\" },\n    \"Patients ‚Äì Care Department\":  { flag: \"show_board_patients\", status_field: \"status_patients\" },\n  };\n\n  // --- –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è ---\n  const open_kanban = (board) => frappe.set_route(\"List\", DOCTYPE, \"Kanban\", board);\n  const open_list_general = () => frappe.set_route(\"List\", DOCTYPE);\n  const open_list_for_board = (board) => {\n    const meta = BOARD_META[board];\n    try {\n      frappe.route_options = {};\n      if (meta) frappe.route_options[meta.flag] = 1; // —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ñ–ª–∞–≥—É –¥–æ—Å–∫–∏\n    } catch {}\n    open_list_general();\n  };\n\n  // –°–æ–∑–¥–∞–Ω–∏–µ –∫–µ–π—Å–∞ –≤ –∞–∫—Ç–∏–≤–Ω–æ–π –¥–æ—Å–∫–µ: —Ñ–ª–∞–≥ + –ø–µ—Ä–≤—ã–π —Å—Ç–∞—Ç—É—Å\n  async function create_case_for_board(board) {\n    const meta = BOARD_META[board];\n    if (!meta) return;\n    let firstStatus = null;\n    try {\n      const dtmeta = await new Promise(res => frappe.model.with_doctype(DOCTYPE, () => res(frappe.get_meta(DOCTYPE))));\n      const sf = (dtmeta.fields || []).find(f => f.fieldname === meta.status_field);\n      firstStatus = String(sf?.options || \"\").split(\"\\n\").map(s => s.trim()).filter(Boolean)[0] || null;\n    } catch {}\n    try {\n      frappe.route_options = {};\n      frappe.route_options[meta.flag] = 1;\n      if (firstStatus) frappe.route_options[meta.status_field] = firstStatus;\n    } catch {}\n    frappe.new_doc(DOCTYPE);\n  }\n\n  const fullPath = (p) => p ? (p.startsWith(\"/\") ? p : `/${p}`) : \"\";\n  const sepChip  = `<span class=\"crm-vsep\" aria-hidden=\"true\"></span>`;\n\n  // --- –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è ---\n  async function ensure_messages(timeout_ms = 2000) {\n    const start = Date.now();\n    while (Date.now() - start < timeout_ms) {\n      if (typeof __ === \"function\") return true;\n      if (frappe && frappe._messages && Object.keys(frappe._messages).length) return true;\n      await new Promise(r => setTimeout(r, 50));\n    }\n    return false;\n  }\n  await ensure_messages();\n\n  const t = (s) => {\n    try {\n      if (typeof __ === \"function\") return __(s);\n      const dict = (frappe && frappe._messages) ? frappe._messages : null;\n      return (dict && typeof dict[s] === \"string\" && dict[s].length) ? dict[s] : s;\n    } catch { return s; }\n  };\n  const tf = (s, args=[]) => {\n    try { if (typeof __ === \"function\") return __(s, args); } catch {}\n    return s.replace(/\\{(\\d+)\\}/g, (_, i) => (args[i] ?? \"\"));\n  };\n\n  const UI = {\n    title: t(\"Engagement Boards\"),\n    subtitle: t(\"Quick overview & jump\"),\n    new_case: t(\"New Case\"),\n    all_cases: t(\"All Cases\"),\n    add_in: t(\"Add to {0}\"),\n    board_list: t(\"Board List\"),\n    board_kanban: t(\"Board Kanban\"),\n    group_board: t(\"This board\"),\n    group_global: t(\"Global\"),\n    tab_crm: t(\"CRM\"),\n    tab_leads: t(\"Leads\"),\n    tab_deals: t(\"Deals\"),\n    tab_patients: t(\"Patients\"),\n    all: t(\"All\"),\n    last: t(\"Last\"),\n    first: t(\"First\"),\n    upd: t(\"Upd\"),\n  };\n\n  function shortLabel(board) {\n    if (board === \"Leads ‚Äì Contact Center\") return UI.tab_leads;\n    if (board === \"Deals ‚Äì Contact Center\") return UI.tab_deals;\n    if (board === \"Patients ‚Äì Care Department\") return UI.tab_patients;\n    if (board === \"CRM Board\") return UI.tab_crm;\n    return board || \"\";\n  }\n\n  // --- –∑–µ—Ä–∫–∞–ª–∏–º —Ç–µ–º—É —Ä–∞–Ω–æ ---\n  function mirrorThemeTag() {\n    const tag = (document.documentElement.getAttribute('data-theme') || 'light').toLowerCase();\n    const host = getHost();\n    if (host) host.setAttribute('data-theme', tag);\n    const card = q('.crm-card'); if (card && card.setAttribute) card.setAttribute('data-theme', tag);\n  }\n  mirrorThemeTag();\n\n  // --- UI helpers ---\n  function update_active_labels() {\n    const activeBoard =\n      q('.crm-tab.-active')?.getAttribute('data-board') ||\n      q('.crm-tab')?.getAttribute('data-board') ||\n      \"Leads ‚Äì Contact Center\";\n\n    const labelTxt = esc(shortLabel(activeBoard));\n    const addBtn = q('[data-action=\"new-in-active\"]');\n    if (addBtn) {\n      addBtn.innerHTML = `<i class=\"crm-ico crm-ico-plus\"></i><span>${tf(UI.add_in, [labelTxt])}</span>`;\n    }\n  }\n\n  function localizeRelTime(html) {\n    if (!html) return \"\";\n    let txt = html;\n    const map = {\n      \"hours ago\": t(\"hours ago\"),\n      \"hour ago\": t(\"hour ago\"),\n      \"minutes ago\": t(\"minutes ago\"),\n      \"minute ago\": t(\"minute ago\"),\n      \"just now\": t(\"just now\"),\n      \"yesterday\": t(\"yesterday\"),\n      \"days ago\": t(\"days ago\"),\n      \"an hour ago\": t(\"an hour ago\"),\n      \"a minute ago\": t(\"a minute ago\"),\n    };\n    for (const [en, ru] of Object.entries(map)) if (en !== ru) txt = txt.replace(en, ru);\n    return txt;\n  }\n\n  // chips\n  function tag(val, bucket) {\n    if (!val) return \"\";\n    const txt = t(String(val));\n    if (typeof window.tagChip === \"function\") return window.tagChip(bucket, txt, false);\n    return `<span class=\"crm-chip\">${esc(txt)}</span>`;\n  }\n  function kchip(boardName, status, dashed=false) {\n    if (!status) return \"\";\n    if (typeof window.boardChip === \"function\") {\n      let html = window.boardChip(boardName, status, dashed);\n      try {\n        const tmp = document.createElement(\"div\");\n        tmp.innerHTML = html;\n        const span = tmp.querySelector(\"span, .crm-chip, .kanban-chip, .label\");\n        if (span) span.textContent = t(span.textContent || status);\n        html = tmp.innerHTML;\n      } catch {\n        html = `<span class=\"crm-chip\">${esc(t(status))}</span>`;\n      }\n      return html;\n    }\n    const extra = dashed ? \"border-style:dashed;background:transparent\" : \"\";\n    return `<span class=\"crm-chip\" style=\"${extra}\">${esc(t(status))}</span>`;\n  }\n  const timeChip = (label, dt) => {\n    if (!dt) return \"\";\n    const rel = (frappe && frappe.datetime && frappe.datetime.comment_when) ? frappe.datetime.comment_when(dt) : esc(dt);\n    const localized = localizeRelTime(rel);\n    return `<span class=\"crm-chip -ghost\"><span class=\"lbl\">${esc(label)}:</span> ${localized}</span>`;\n  };\n\n  // --- –∫–ª–∏–∫–∏ ---\n  qq('button[data-action]').forEach(b => b.setAttribute('type','button'));\n\n  root.addEventListener(\"click\", (e) => {\n    const btn = e.target.closest(\"[data-action], .crm-tab\");\n    if (!btn || !(root.contains ? root.contains(btn) : true)) return;\n    const isTab = btn.classList.contains(\"crm-tab\");\n    e.preventDefault(); e.stopPropagation();\n\n    if (isTab) {\n      const board = btn.getAttribute(\"data-board\");\n      if (!board) return;\n      qq(\".crm-tab\").forEach(t => t.classList.toggle(\"-active\", t === btn));\n      update_active_labels();\n      loadBoard(board); // –æ–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–≤—å—é/–º–µ—Ç—Ä–∏–∫–∏ –ø–æ–¥ –∞–∫—Ç–∏–≤–Ω—É—é –¥–æ—Å–∫—É\n      return;\n    }\n\n    const act = btn.getAttribute(\"data-action\");\n    const activeBoard =\n      q('.crm-tab.-active')?.getAttribute('data-board') ||\n      q('.crm-tab')?.getAttribute('data-board');\n\n    if (act === \"open-board-list\" && activeBoard) { open_list_for_board(activeBoard); return; }\n    if (act === \"open-board-kanban\" && activeBoard) { open_kanban(activeBoard); return; }\n    if (act === \"open-all-list\") { open_list_general(); return; }\n    if (act === \"new-case\") { frappe.new_doc(DOCTYPE); return; }\n    if (act === \"new-in-active\" && activeBoard) { create_case_for_board(activeBoard); return; }\n  }, true);\n\n  // --- –º–µ—Ç—Ä–∏–∫–∏/–ø—Ä–µ–≤—å—é (–∫–∞–∫ –±—ã–ª–æ) ---\n  async function renderMetrics(boardName, statusField) {\n    try { if (typeof window.getBoardColors === \"function\") await window.getBoardColors(boardName); } catch {}\n    const colorMap = (window.EC_BOARD_COLORS && window.EC_BOARD_COLORS[boardName]) || {};\n\n    let columns = [];\n    try {\n      const { message: kb } = await frappe.call({ method: \"frappe.client.get\", args: { doctype: \"Kanban Board\", name: boardName } });\n      if (kb && Array.isArray(kb.columns)) {\n        columns = kb.columns.filter(c => (c.status || \"Active\") === \"Active\").map(c => c.column_name);\n      }\n    } catch {}\n    if (!columns.length) {\n      try {\n        const doctypeMeta = await new Promise(res => frappe.model.with_doctype(DOCTYPE, () => res(frappe.get_meta(DOCTYPE))));\n        const sf = (doctypeMeta.fields || []).find(f => f.fieldname === (BOARD_META[boardName]?.status_field));\n        columns = String(sf?.options || \"\").split(\"\\n\").map(s => s.trim()).filter(Boolean);\n      } catch {}\n    }\n\n    const wrap = q(\".crm-metrics\"); if (!wrap) return;\n    const blocks = [\n      `<div class=\"crm-metric\" data-key=\"__all\"><span class=\"lbl\">${esc(UI.all)}</span><span class=\"val\">‚Äî</span></div>`,\n      ...columns.map(name => {\n        const c = colorMap[name];\n        const style = c ? `background:${c.bg};border-color:${c.bd}` : `background:var(--control-bg);border-color:var(--border-color)`;\n        return `<div class=\"crm-metric\" style=\"${style}\" data-key=\"${esc(name)}\">\n                  <span class=\"lbl\">${esc(t(name))}</span>\n                  <span class=\"val\">‚Äî</span>\n                </div>`;\n      })\n    ];\n    wrap.innerHTML = blocks.join(\"\");\n  }\n\n  function setMetric(key, val) {\n    const node = q(`.crm-metric[data-key=\"${CSS.escape(key)}\"] .val`);\n    if (node) node.textContent = String(val ?? 0);\n  }\n\n  async function loadBoard(boardName) {\n    const meta = BOARD_META[boardName];\n    if (!meta) { console.warn(\"[CRM Tabs] unknown board:\", boardName); return; }\n\n    await renderMetrics(boardName, meta.status_field);\n\n    // counts\n    try {\n      const { message: counts } = await frappe.call({\n        method: \"dantist_app.api.engagement.handlers.engagement_board_counts\",\n        args: { flag_field: meta.flag, status_field: meta.status_field }\n      });\n      setMetric(\"__all\", counts?.__all ?? 0);\n      Object.entries(counts?.by_status || {}).forEach(([name, v]) => setMetric(name, v || 0));\n    } catch { setMetric(\"__all\", \"‚Äì\"); }\n\n    // preview\n    const wrap = q('[data-region=\"preview\"]'); if (!wrap) return;\n    wrap.innerHTML = `<div class=\"crm-skel\"><div class=\"crm-skel__row\"></div><div class=\"crm-skel__row\"></div><div class=\"crm-skel__row\"></div></div>`;\n\n    let rows = [];\n    try {\n      const { message=[] } = await frappe.call({\n        method: \"dantist_app.api.engagement.handlers.engagement_board_preview\",\n        args: { flag_field: meta.flag, status_field: meta.status_field, limit: 6 }\n      });\n      rows = message || [];\n    } catch {}\n\n    wrap.innerHTML = \"\";\n    rows.forEach(doc => {\n      const st = doc[meta.status_field];\n      const stChip = st ? kchip(boardName, st, false) : \"\";\n      const platformChip = tag(doc.channel_platform, \"platform\");\n      const langChip = doc.preferred_language ? `<span class=\"crm-chip -ghost\">${esc(String(doc.preferred_language).toLowerCase())}</span>` : \"\";\n      const prBadge = doc.priority ? `<span class=\"crm-badge\">${esc(tf(\"P: {0}\", [t(doc.priority)]))}</span>` : \"\";\n      const fallbackAvatar = \"/assets/dantist_app/files/egg.png\";\n      const avatarSrc = fullPath(doc.avatar) || fallbackAvatar;\n\n      const times = [\n        timeChip(UI.last, doc.last_event_at),\n        timeChip(UI.first, doc.first_event_at),\n        timeChip(UI.upd, doc.modified)\n      ].filter(Boolean).join(\" \");\n\n      const metaLine = [platformChip, langChip, stChip ? (sepChip + stChip) : \"\"].join(\"\");\n\n      wrap.insertAdjacentHTML(\"beforeend\", `\n        <div class=\"crm-item\" data-name=\"${esc(doc.name)}\">\n          <div class=\"crm-left\">\n            <div class=\"crm-avatar\"><img src=\"${esc(avatarSrc)}\" alt=\"\"></div>\n            <div class=\"crm-body\">\n              <div class=\"crm-title\">${esc(doc.title || doc.display_name || doc.name)}</div>\n              <div class=\"crm-meta\">${metaLine}</div>\n              <div class=\"crm-meta -time\">${times}</div>\n            </div>\n          </div>\n          <div class=\"crm-right\">${prBadge}</div>\n        </div>\n      `);\n    });\n\n    qq(\".crm-item\", wrap).forEach(row =>\n      row.addEventListener(\"click\", () => frappe.set_route(\"Form\", DOCTYPE, row.getAttribute(\"data-name\")))\n    );\n  }\n\n  // --- –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ HTML ---\n  (() => {\n    const tEl = q(\".crm-card__title .t\"); if (tEl) tEl.textContent = UI.title;\n    const sEl = q(\".crm-card__title .s\"); if (sEl) sEl.textContent = UI.subtitle;\n\n    const g1 = q('.crm-actions.-board .crm-actions__label');  if (g1) g1.textContent = UI.group_board;\n    const g2 = q('.crm-actions.-global .crm-actions__label'); if (g2) g2.textContent = UI.group_global;\n\n    // –ø–æ–¥–ø–∏—Å–∏ –≤–∫–ª–∞–¥–æ–∫\n    qq(\".crm-tab\").forEach(tab => {\n      const key = tab.getAttribute(\"data-board\");\n      if (key === \"CRM Board\") tab.textContent = UI.tab_crm;\n      if (key === \"Leads ‚Äì Contact Center\") tab.textContent = UI.tab_leads;\n      if (key === \"Deals ‚Äì Contact Center\") tab.textContent = UI.tab_deals;\n      if (key === \"Patients ‚Äì Care Department\") tab.textContent = UI.tab_patients;\n    });\n\n    update_active_labels();\n  })();\n\n  // --- —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã, –±–µ–∑ –∞–≤—Ç–æ–ø–µ—Ä–µ—Ö–æ–¥–æ–≤ ---\n  (function themeSyncSafe() {\n    const refreshActive = () => {\n      mirrorThemeTag();\n      const active = q('.crm-tab.-active')?.getAttribute('data-board')\n        || q('.crm-tab')?.getAttribute('data-board')\n        || \"Leads ‚Äì Contact Center\";\n      try { loadBoard(active); update_active_labels(); } catch(e) { console.warn(e); }\n    };\n    try {\n      new MutationObserver(() => { refreshActive(); })\n        .observe(document.documentElement, { attributes: true, attributeFilter: ['data-theme'] });\n    } catch {}\n    window.addEventListener('ec_board_colors:theme_changed', refreshActive);\n  })();\n\n  // --- INIT: —Å—Ç–∞—Ä—Ç—É–µ–º –Ω–∞ –ø—Ä–µ–≤—å—é ---\n  try {\n    if (typeof window.getBoardColors === \"function\") {\n      await Promise.all(Object.keys(BOARD_META).map(b => window.getBoardColors(b)));\n    }\n  } catch {}\n\n  const initialBoard =\n    q('.crm-tab.-active')?.getAttribute('data-board') ||\n    q('.crm-tab')?.getAttribute('data-board') ||\n    \"Leads ‚Äì Contact Center\";\n\n  loadBoard(initialBoard);\n\n})(root_element);",
  "style": "/* ===== Card & header ===== */\n.crm-card{\n  background: var(--card-bg, #fff);\n  border: 1px solid var(--border-color, #e5e7eb);\n  border-radius: 12px;\n  padding: 14px;\n  box-shadow: var(--shadow-base, 0 1px 0 rgba(0,0,0,.02));\n}\n.crm-card__header{display:flex;align-items:center;justify-content:space-between;gap:12px}\n.crm-card__title{display:flex;align-items:center;gap:10px}\n.crm-card__title .t{font-weight:600;font-size:16px;line-height:1.1;color:var(--text-color)}\n.crm-card__title .s{color:var(--text-muted,#6b7280);font-size:12px;margin-top:2px}\n\n/* ===== Actions (2 —Ä—è–¥–∞, –∫—Ä–∞—Å–∏–≤–æ –∏ —Ä–æ–≤–Ω–æ) ===== */\n.crm-card__actions{min-width:260px}\n.crm-actions-grid{\n  display:grid;\n  grid-template-columns: 1fr;\n  gap:10px;\n}\n@media (min-width: 860px){\n  .crm-actions-grid{grid-template-columns:1fr 1fr;align-items:stretch}\n}\n.crm-actions{\n  display:grid;\n  grid-template-columns: auto 1fr;\n  align-items:center;\n  gap:10px 12px;\n  background: var(--control-bg,#f8fafc);\n  border:1px solid var(--border-color,#e5e7eb);\n  border-radius:12px;\n  padding:10px 12px;\n  height:100%;\n}\n.crm-actions.-global{\n  background: color-mix(in oklab, var(--control-bg) 90%, white);\n}\n.crm-actions__label{\n  grid-column:1/2;\n  align-self:start;\n  font-size:10px;letter-spacing:.04em;text-transform:uppercase;\n  color:var(--text-muted,#6b7280);\n  padding:4px 6px;border:1px dashed var(--border-color,#e5e7eb);\n  border-radius:999px;background:color-mix(in oklab, var(--control-bg) 70%, transparent);\n}\n.crm-actions__btns{\n  grid-column:2/3;\n  display:flex;flex-wrap:wrap;gap:8px;align-items:center;\n}\n\n/* >>> –ù–æ–≤–æ–µ: –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º –±–ª–æ–∫–µ ‚Äî –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å—Ç–µ–∫, –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É */\n.crm-actions.-global .crm-actions__btns{\n  flex-direction: column;\n  align-items: stretch;\n  gap: 6px;\n}\n.crm-actions.-global .btn{\n  width: 100%;\n  justify-content: center;\n}\n\n.crm-card__actions .btn{\n  border-radius:10px;\n  display:inline-flex;align-items:center;gap:6px;\n  min-height:30px;padding:6px 10px;line-height:1;white-space:nowrap;\n}\n.crm-card__actions .btn.btn-default{\n  background:var(--card-bg,#fff);\n  border-color:var(--border-color,#e5e7eb);\n}\n.crm-card__actions .btn.btn-default:hover{\n  background:var(--fg-hover-color,#f6f7f9);\n}\n.crm-card__actions .btn.btn-primary{\n  border-color:color-mix(in oklab, var(--brand-primary,#3b82f6) 80%, black 0%);\n  box-shadow:0 1px 0 rgba(0,0,0,.03);\n}\n\n/* ===== Icons ===== */\n.crm-ico{display:inline-block;flex:0 0 auto;width:16px;height:16px}\n.crm-ico-kanban{\n  background: linear-gradient(180deg, #6366f1, #8b5cf6);\n  -webkit-mask:url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M4 5h4v14H4V5zm6 4h4v10h-4V9zm6-6h4v16h-4V3z\"/></svg>') no-repeat 50%/contain;\n  mask:url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M4 5h4v14H4V5zm6 4h4v10h-4V9zm6-6h4v16h-4V3z\"/></svg>') no-repeat 50%/contain;\n}\n.crm-ico-list{\n  background:linear-gradient(180deg,#0ea5e9,#6366f1);\n  -webkit-mask:url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M4 6h16v2H4V6zm0 5h16v2H4v-2zm0 5h16v2H4v-2z\"/></svg>') no-repeat 50%/contain;\n  mask:url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M4 6h16v2H4V6zm0 5h16v2H4v-2zm0 5h16v2H4v-2z\"/></svg>') no-repeat 50%/contain;\n}\n.crm-ico-plus{\n  background:linear-gradient(180deg,#22c55e,#3b82f6);\n  -webkit-mask:url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M11 5h2v14h-2zM5 11h14v2H5z\"/></svg>') no-repeat 50%/contain;\n  mask:url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M11 5h2v14h-2zM5 11h14v2H5z\"/></svg>') no-repeat 50%/contain;\n}\n.crm-ico-boards{\n  background:linear-gradient(180deg,#14b8a6,#6366f1);\n  -webkit-mask:url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M3 3h8v8H3V3zm10 0h8v8h-8V3zM3 13h8v8H3v-8zm10 0h8v8h-8v-8z\"/></svg>') no-repeat 50%/contain;\n  mask:url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M3 3h8v8H3V3zm10 0h8v8h-8V3zM3 13h8v8H3v-8zm10 0h8v8h-8v-8z\"/></svg>') no-repeat 50%/contain;\n}\n\n/* ===== Tabs ===== */\n.crm-tabs{display:flex;gap:6px;margin:10px 0 6px}\n.crm-card .crm-tab{\n  border:1px solid var(--border-color,#e5e7eb);\n  background: var(--control-bg,#f8fafc);\n  color: var(--text-color);\n  border-radius:10px;padding:6px 10px;font-size:12px;\n  transition: background .15s ease, color .15s ease, border-color .15s ease, box-shadow .15s ease;\n}\n.crm-card .crm-tab.-active{\n  background:#eef2ff;border-color:#c7d2fe;box-shadow:inset 0 0 0 1px #c7d2fe;color:#111827;\n}\n/* LIGHT */\n.crm-card[data-theme=\"light\"] .crm-tab.-active,\n[data-theme=\"light\"] .crm-card .crm-tab.-active{\n  background:#eef2ff;border-color:#c7d2fe;box-shadow:inset 0 0 0 1px #c7d2fe;color:#111827;\n}\n/* DARK */\n.crm-card[data-theme=\"dark\"] .crm-tab,\n[data-theme=\"dark\"] .crm-card .crm-tab{\n  background:var(--control-bg);border-color:var(--btn-group-border-color,var(--border-color));color:var(--text-muted);\n}\n.crm-card[data-theme=\"dark\"] .crm-tab:hover,\n[data-theme=\"dark\"] .crm-card .crm-tab:hover{\n  background:var(--fg-hover-color);color:var(--text-color);border-color:var(--border-color);\n}\n.crm-card[data-theme=\"dark\"] .crm-tab.-active,\n[data-theme=\"dark\"] .crm-card .crm-tab.-active{\n  background:var(--subtle-accent);border-color:var(--dark-border-color);box-shadow:inset 0 0 0 1px var(--dark-border-color);color:var(--text-color);\n}\n.crm-card[data-theme=\"dark\"] .crm-tab:focus-visible,\n[data-theme=\"dark\"] .crm-card .crm-tab:focus-visible{\n  outline:2px solid color-mix(in oklab, var(--brand-primary) 40%, transparent);outline-offset:2px;\n}\n\n/* ===== Metrics ===== */\n.crm-metrics{display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:8px;margin:8px 0 6px}\n.crm-metric{\n  background: var(--control-bg,#f8fafc);\n  border:1px solid var(--border-color,#eef2f7);\n  border-radius:10px;padding:10px\n}\n.crm-metric .lbl{display:block;font-size:11px;color:var(--text-muted,#6b7280)}\n.crm-metric .val{display:block;font-weight:700;font-size:18px;margin-top:2px;color:var(--text-color)}\n\n/* ===== List preview (–∫–∞–∫ –±—ã–ª–æ) ===== */\n.crm-list{margin-top:6px}\n.crm-item{\n  display:flex;align-items:flex-start;justify-content:space-between;gap:10px;\n  padding:10px;border:1px solid var(--border-color,#eef2f7);\n  border-radius:10px;margin-top:8px;cursor:pointer;\n  background: var(--card-bg, #ffffff);\n  color: var(--text-color);\n  transition: background .15s ease\n}\n.crm-item:hover{background: var(--fg-hover-color,#fafafa)}\n.crm-left{display:flex;gap:10px;align-items:flex-start;min-width:0}\n.crm-avatar{width:28px;height:28px;border-radius:8px;background:var(--bg-light-gray,#e5e7eb);flex:0 0 auto;overflow:hidden}\n.crm-avatar img{width:100%;height:100%;object-fit:cover;display:block}\n.crm-body{min-width:0}\n.crm-title{font-weight:600;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--text-color)}\n\n/* ===== Chips ===== */\n.crm-chip{\n  font-size:10px;padding:2px 6px;border-radius:999px;\n  border:1px solid var(--border-color,#e5e7eb);\n  background: var(--bg-light-gray, #f3f4f6);\n  color: var(--text-color)\n}\n.crm-chip.-ghost{background: var(--control-bg,#f8fafc)}\n.crm-chip.-kanban{color: var(--text-color)}\n.crm-vsep{display:inline-block;width:0;border-left:1px dashed var(--border-color,#d1d5db);margin:0 6px;align-self:stretch}\n\n/* ===== Meta / Badge ===== */\n.crm-meta{color:var(--text-muted,#6b7280);font-size:11px;margin-top:2px;display:flex;gap:8px;flex-wrap:wrap}\n.crm-meta.-time .frappe-timestamp{opacity:.9}\n.crm-right{display:flex;align-items:center;gap:8px}\n.crm-badge{font-size:10px;padding:3px 8px;border-radius:999px;border:1px dashed var(--border-color,#d1d5db);color:var(--text-color)}\n\n/* ===== Skeleton ===== */\n.crm-skel__row{\n  height:44px;border-radius:10px;\n  background: linear-gradient(90deg,\n    color-mix(in oklab, var(--control-bg) 90%, white),\n    var(--control-bg),\n    color-mix(in oklab, var(--control-bg) 90%, white)\n  );\n  background-size:200% 100%;animation:skel 1.2s infinite;margin-top:8px\n}\n@keyframes skel{0%{background-position:0 0}100%{background-position:200% 0}}"
 },
 {
  "docstatus": 0,
  "doctype": "Custom HTML Block",
  "html": "<!-- AIHub welcome block -->\n<div class=\"aihub-welcome\"></div>\n\n<style>\n  /* AIHub welcome ‚Äî neutral theme (no hard colors/bg) */\n  .aihub-welcome {\n    padding: 24px;\n    margin: 0 auto;\n    max-width: 980px;\n    line-height: 1.6;\n    font-size: 16px;\n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto,\n                 \"Helvetica Neue\", Arial, sans-serif;\n  }\n  .aihub-welcome .aihub-title {\n    margin: 0 0 8px;\n    font-weight: 600;\n  }\n  .aihub-welcome .aihub-p {\n    margin: 0 0 10px;\n  }\n  .aihub-welcome .aihub-list {\n    margin: 0 0 10px 18px;\n    padding: 0;\n  }\n</style>",
  "modified": "2025-10-23 18:31:52.850351",
  "name": "Welcome Text",
  "private": 0,
  "roles": [],
  "script": "(function(root_element){\n  if (!root_element) { return; }\n\n  // ------- helpers (–±–µ–∑ –±—ç–∫—Ç–∏–∫–æ–≤, —Ç–æ–ª—å–∫–æ –¥–≤–æ–π–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏)\n  function safe(obj, path, dflt) {\n    if (dflt === void 0) dflt = \"\";\n    try {\n      var parts = path.split(\".\");\n      var cur = obj;\n      for (var i=0; i<parts.length; i++) {\n        if (cur == null) return dflt;\n        cur = cur[parts[i]];\n      }\n      return (cur === undefined || cur === null) ? dflt : cur;\n    } catch (e) { return dflt; }\n  }\n  function readCookie(name){\n    var m = document.cookie.match(new RegExp(\"(?:^|;\\\\s*)\" + name + \"=([^;]+)\"));\n    return m ? decodeURIComponent(m[1]) : \"\";\n  }\n  function mapCode(s){\n    var v = String(s || \"\").toLowerCase();\n    if (v.indexOf(\"ru\") === 0) return \"ru\";\n    if (v.indexOf(\"uk\") === 0 || v.indexOf(\"ua\") === 0) return \"uk\";\n    if (v.indexOf(\"pl\") === 0) return \"pl\";\n    if (v.indexOf(\"ka\") === 0 || v.indexOf(\"geor\") > -1) return \"ka\";\n    if (v.indexOf(\"be\") === 0) return \"be\";\n    return \"en\";\n  }\n  function pickLang(){\n    var fb   = window.frappe || {};\n    var boot = fb.boot || {};\n    var usr  = boot.user || {};\n    var defs = usr.defaults || usr.user_defaults || {};\n\n    var pool = [\n      { src: \"user.language\",              code: usr.language || \"\" },\n      { src: \"user.user_language\",         code: usr.user_language || \"\" },\n      { src: \"user.defaults.language\",     code: defs.language || \"\" },\n      { src: \"user.defaults.lang\",         code: defs.lang || \"\" },\n      { src: \"cookie.preferred_language\",  code: readCookie(\"preferred_language\") },\n      { src: \"cookie.lang\",                code: readCookie(\"lang\") },\n      { src: \"boot.lang\",                  code: boot.lang || \"\" },\n      { src: \"sysdefaults.language\",       code: safe(boot, \"sysdefaults.language\", \"\") },\n      { src: \"navigator.languages[0]\",     code: (navigator.languages && navigator.languages[0]) || \"\" },\n      { src: \"navigator.language\",         code: navigator.language || \"\" }\n    ];\n\n    var chosen = \"en\", chosenSrc = \"fallback.en\";\n    for (var i=0; i<pool.length; i++){\n      var raw = String(pool[i].code || \"\").trim();\n      if (!raw) continue;\n      chosen = mapCode(raw);\n      chosenSrc = pool[i].src;\n      break;\n    }\n\n    try {\n      // –ª–æ–≥ –≤ –∫–æ–Ω—Å–æ–ª—å –ø–µ—Å–æ—á–Ω–∏—Ü—ã –≤–æ—Ä–∫—Å–ø–µ–π—Å–∞\n      console.groupCollapsed(\"[AIHub welcome] i18n\");\n      console.table(pool.map(function(x){ return { source: x.src, raw: x.code, mapped: x.code ? mapCode(x.code) : \"\" }; }));\n      console.info(\"chosen:\", chosen, \"from:\", chosenSrc);\n      console.groupEnd();\n    } catch (e) {}\n\n    return chosen;\n  }\n\n  // ------- —Å–ª–æ–≤–∞—Ä–∏\n  var M = {\n    en: {\n      title: \"‚ú® Welcome to AIHub\",\n      p1: \"Your familiar platform for <strong>assistants</strong> and the <strong>knowledge base</strong> ‚Äî now with a refreshed interface. üéõÔ∏èü§ñ<br>Everything you know is still here; we‚Äôve just polished the navigation and made everyday tasks a bit smoother. üöÄ\",\n      b1: \"Clearer layout for assistants & knowledge tools üìö\",\n      b2: \"Subtle UX improvements across common flows ‚ú®\",\n      b3: \"Same features you trust, easier to reach üß≠\",\n      p2: \"Take a look around ‚Äî and if anything feels off, let us know. We‚Äôre listening. üí¨\"\n    },\n    ru: {\n      title: \"‚ú® –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ AIHub\",\n      p1: \"–ó–Ω–∞–∫–æ–º–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è <strong>–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤</strong> –∏ <strong>–±–∞–∑—ã –∑–Ω–∞–Ω–∏–π</strong> ‚Äî —Ç–µ–ø–µ—Ä—å —Å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º. üéõÔ∏èü§ñ<br>–í—Å—ë, —á—Ç–æ –≤—ã –∑–Ω–∞–µ—Ç–µ, –Ω–∞ –º–µ—Å—Ç–µ; –º—ã –ª–∏—à—å –æ—Ç–ø–æ–ª–∏—Ä–æ–≤–∞–ª–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—é –∏ —É–ø—Ä–æ—Å—Ç–∏–ª–∏ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏. üöÄ\",\n      b1: \"–ë–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π üìö\",\n      b2: \"–ù–µ–∑–∞–º–µ—Ç–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è UX –≤ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö ‚ú®\",\n      b3: \"–¢–µ –∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–º –≤—ã –¥–æ–≤–µ—Ä—è–µ—Ç–µ, ‚Äî –±–ª–∏–∂–µ –ø–æ–¥ —Ä—É–∫–æ–π üß≠\",\n      p2: \"–û—Å–º–æ—Ç—Ä–∏—Ç–µ—Å—å ‚Äî –∏ –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å. –ú—ã –ø—Ä–∏—Å–ª—É—à–∏–≤–∞–µ–º—Å—è. üí¨\"\n    },\n    uk: {\n      title: \"‚ú® –õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –¥–æ AIHub\",\n      p1: \"–ó–Ω–∞–π–æ–º–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è <strong>–∞—Å–∏—Å—Ç–µ–Ω—Ç—ñ–≤</strong> —ñ <strong>–±–∞–∑–∏ –∑–Ω–∞–Ω—å</strong> ‚Äî —Ç–µ–ø–µ—Ä –∑ –æ–Ω–æ–≤–ª–µ–Ω–∏–º —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º. üéõÔ∏èü§ñ<br>–£—Å–µ –∑–Ω–∞–π–æ–º–µ –∑–∞–ª–∏—à–∏–ª–æ—Å—è; –º–∏ –ø—ñ–¥–ø—Ä–∞–≤–∏–ª–∏ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é —Ç–∞ —Å–ø—Ä–æ—Å—Ç–∏–ª–∏ —â–æ–¥–µ–Ω–Ω—ñ –¥—ñ—ó. üöÄ\",\n      b1: \"–ó—Ä–æ–∑—É–º—ñ–ª—ñ—à–µ –∫–æ–º–ø–æ–Ω—É–≤–∞–Ω–Ω—è –¥–ª—è –∞—Å–∏—Å—Ç–µ–Ω—Ç—ñ–≤ —ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –±–∞–∑–∏ –∑–Ω–∞–Ω—å üìö\",\n      b2: \"–î—Ä—ñ–±–Ω—ñ –ø–æ–ª—ñ–ø—à–µ–Ω–Ω—è UX —É —Ç–∏–ø–æ–≤–∏—Ö –ø—Ä–æ—Ü–µ—Å–∞—Ö ‚ú®\",\n      b3: \"–¢—ñ —Å–∞–º—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ, —è–∫–∏–º –≤–∏ –¥–æ–≤—ñ—Ä—è—î—Ç–µ, ‚Äî —à–≤–∏–¥—à–µ –ø—ñ–¥ —Ä—É–∫–æ—é üß≠\",\n      p2: \"–û–∑–∏—Ä–Ω—ñ—Ç—å—Å—è ‚Äî —ñ —è–∫—â–æ —â–æ—Å—å –Ω–µ —Ç–∞–∫, –ø–æ–≤—ñ–¥–æ–º—Ç–µ –Ω–∞–º. –ú–∏ –≤–∞—Å —á—É—î–º–æ. üí¨\"\n    },\n    pl: {\n      title: \"‚ú® Witamy w AIHub\",\n      p1: \"Znana platforma dla <strong>asystent√≥w</strong> i <strong>bazy wiedzy</strong> ‚Äî teraz z od≈õwie≈ºonym interfejsem. üéõÔ∏èü§ñ<br>Wszystko, co znasz, jest na swoim miejscu; dopracowali≈õmy nawigacjƒô i u≈Çatwili≈õmy codzienne zadania. üöÄ\",\n      b1: \"Czytelniejszy uk≈Çad dla asystent√≥w i narzƒôdzi bazy wiedzy üìö\",\n      b2: \"Drobne usprawnienia UX w typowych przep≈Çywach ‚ú®\",\n      b3: \"Te same funkcje, kt√≥rym ufasz ‚Äî ≈Çatwiej dostƒôpne üß≠\",\n      p2: \"Rozejrzyj siƒô ‚Äî a je≈õli co≈õ bƒôdzie nie tak, daj nam znaƒá. S≈Çuchamy. üí¨\"\n    },\n    ka: {\n      title: \"‚ú® ·Éô·Éî·Éó·Éò·Éö·Éò ·Éò·Éß·Éù·É° ·Éó·É•·Éï·Éî·Éú·Éò ·Éõ·Éù·Éë·É†·É´·Éê·Éú·Éî·Éë·Éê AIHub-·É®·Éò\",\n      p1: \"·Éó·É•·Éï·Éî·Éú·Éó·Éï·Éò·É° ·Éú·Éê·É™·Éú·Éù·Éë·Éò ·Éû·Éö·Éê·É¢·É§·Éù·É†·Éõ·Éê <strong>·Éê·É°·Éò·É°·É¢·Éî·Éú·É¢·Éî·Éë·Éò·É°·Éó·Éï·Éò·É°</strong> ·Éì·Éê <strong>·É™·Éù·Éì·Éú·Éò·É° ·Éë·Éê·Éñ·Éò·É°·Éó·Éï·Éò·É°</strong> ‚Äî ·Éê·ÉÆ·Éö·Éê ·Éí·Éê·Éú·Éê·ÉÆ·Éö·Éî·Éë·É£·Éö·Éò ·Éò·Éú·É¢·Éî·É†·É§·Éî·Éò·É°·Éò·Éó. üéõÔ∏èü§ñ<br>·Éß·Éï·Éî·Éö·Éê·É§·Éî·É†·Éò ·Éú·Éê·É™·Éú·Éù·Éë·Éò ·Éò·É°·Éî·Éï ·Éê·É• ·Éê·É†·Éò·É°; ·Éú·Éê·Éï·Éò·Éí·Éê·É™·Éò·Éê ·Éí·Éê·Éï·Éê·É£·Éõ·ÉØ·Éù·Éë·Éî·É°·Éî·Éó ·Éì·Éê ·Éß·Éù·Éï·Éî·Éö·Éì·É¶·Éò·É£·É†·Éò ·Éê·Éõ·Éù·É™·Éê·Éú·Éî·Éë·Éò ·Éù·Éì·Éú·Éê·Éï ·Éí·Éê·Éï·Éê·Éõ·Éê·É†·É¢·Éò·Éï·Éî·Éó. üöÄ\",\n      b1: \"·É£·É§·É†·Éù ·Éí·Éê·É°·Éê·Éí·Éî·Éë·Éò ·Éí·Éê·Éú·Éö·Éê·Éí·Éî·Éë·Éê ·Éê·É°·Éò·É°·É¢·Éî·Éú·É¢·Éî·Éë·Éò·É°·Éê ·Éì·Éê ·É™·Éù·Éì·Éú·Éò·É° ·Éò·Éú·É°·É¢·É†·É£·Éõ·Éî·Éú·É¢·Éî·Éë·Éò·É°·Éó·Éï·Éò·É° üìö\",\n      b2: \"·É¨·Éï·É†·Éò·Éö·Éò UX-·Éí·Éê·É£·Éõ·ÉØ·Éù·Éë·Éî·É°·Éî·Éë·Éî·Éë·Éò ·Éí·Éê·Éï·É†·É™·Éî·Éö·Éî·Éë·É£·Éö ·É°·É™·Éî·Éú·Éê·É†·Éî·Éë·É®·Éò ‚ú®\",\n      b3: \"·Éò·Éí·Éò·Éï·Éî ·É§·É£·Éú·É•·É™·Éò·Éî·Éë·Éò, ·É†·Éù·Éõ·Éö·Éî·Éë·É°·Éê·É™ ·Éî·Éú·Éì·Éù·Éë·Éò·Éó ‚Äî ·Éê·ÉÆ·Éö·Éê ·É£·É§·É†·Éù ·Éõ·Éê·É†·É¢·Éò·Éï·Éê·Éì ·ÉÆ·Éî·Éö·Éõ·Éò·É°·Éê·É¨·Éï·Éì·Éù·Éõ·Éò·Éê üß≠\",\n      p2: \"·Éì·Éê·Éó·Éï·Éê·Éö·Éò·Éî·É†·Éî·Éó ‚Äî ·Éì·Éê ·Éó·É£ ·É†·Éê·Éõ·Éî ·É£·É™·Éú·Éê·É£·É†·Éê·Éì ·Éí·Éî·É©·Éï·Éî·Éú·Éî·Éë·Éê·Éó, ·É®·Éî·Éí·Éï·Éê·É¢·Éß·Éù·Éë·Éò·Éú·Éî·Éó. ·É©·Éï·Éî·Éú ·Éï·É£·É°·Éõ·Éî·Éú·Éó. üí¨\"\n    },\n    be: {\n      title: \"‚ú® –°–∞—Ä–¥—ç—á–Ω–∞ –∑–∞–ø—Ä–∞—à–∞–µ–º —É AIHub\",\n      p1: \"–ó–Ω–∞—ë–º–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è <strong>–ø–∞–º–æ—á–Ω—ñ–∫–∞—û</strong> —ñ <strong>–±–∞–∑—ã –≤–µ–¥–∞—û</strong> ‚Äî —Ü—è–ø–µ—Ä –∑ –∞–±–Ω–æ—û–ª–µ–Ω—ã–º —ñ–Ω—Ç—ç—Ä—Ñ–µ–π—Å–∞–º. üéõÔ∏èü§ñ<br>–£—Å—ë –∑–Ω–∞—ë–º–∞–µ –∑–∞—Å—Ç–∞–ª–æ—Å—è; –º—ã –ø–∞–ª–µ–ø—à—ã–ª—ñ –Ω–∞–≤—ñ–≥–∞—Ü—ã—é —ñ —Å–ø—Ä–∞—Å—Ü—ñ–ª—ñ —à—Ç–æ–¥–∑—ë–Ω–Ω—ã—è –∑–∞–¥–∞—á—ã. üöÄ\",\n      b1: \"–ë–æ–ª—å—à –∑—Ä–∞–∑—É–º–µ–ª–∞—è —Å—Ö–µ–º–∞ –¥–ª—è –ø–∞–º–æ—á–Ω—ñ–∫–∞—û —ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—û –±–∞–∑—ã –≤–µ–¥–∞—û üìö\",\n      b2: \"–ù–µ–≤—è–ª—ñ–∫—ñ—è –ø–∞–ª—è–ø—à—ç–Ω–Ω—ñ UX —É –∑–≤—ã–∫–ª—ã—Ö –ø—Ä–∞—Ü—ç—Å–∞—Ö ‚ú®\",\n      b3: \"–¢—ã—è –∂ –º–∞–≥—á—ã–º–∞—Å—Ü—ñ, —è–∫—ñ–º –≤—ã –¥–∞–≤—è—Ä–∞–µ—Ü–µ, ‚Äî —Ü—è–ø–µ—Ä –ª—è–≥—á—ç–π –¥–∞—Å—Ç—É–ø–Ω—ã—è üß≠\",\n      p2: \"–ü–∞–≥–ª—è–¥–∑—ñ—Ü–µ—Å—è ‚Äî —ñ –∫–∞–ª—ñ –Ω–µ—à—Ç–∞ –Ω–µ —Ç–∞–∫, –ø–∞–≤–µ–¥–∞–º—ñ—Ü–µ –Ω–∞–º. –ú—ã —Å–ª—É—Ö–∞–µ–º. üí¨\"\n    }\n  };\n\n  // ------- render\n  function render(lang){\n    var T = M[lang] || M.en;\n    // –∏—â–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¢–û–õ–¨–ö–û –≤–Ω—É—Ç—Ä–∏ root_element\n    var host = root_element.querySelector(\".aihub-welcome\");\n    if (!host) {\n      host = document.createElement(\"div\");\n      host.className = \"aihub-welcome\";\n      root_element.appendChild(host);\n    }\n    host.setAttribute(\"lang\", lang);\n    host.setAttribute(\"dir\", \"ltr\");\n\n    host.innerHTML =\n      \"<h2 class=\\\"aihub-title\\\">\" + T.title + \"</h2>\" +\n      \"<p class=\\\"aihub-p\\\">\" + T.p1 + \"</p>\" +\n      \"<ul class=\\\"aihub-list\\\">\" +\n        \"<li>\" + T.b1 + \"</li>\" +\n        \"<li>\" + T.b2 + \"</li>\" +\n        \"<li>\" + T.b3 + \"</li>\" +\n      \"</ul>\" +\n      \"<p class=\\\"aihub-p\\\">\" + T.p2 + \"</p>\";\n\n    try { console.log(\"[AIHub welcome] rendered:\", lang); } catch (e) {}\n  }\n\n  // ------- start (–≤ Workspace –∫–æ–¥ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è root_element)\n  try {\n    render(pickLang());\n  } catch (e) {\n    try { console.error(\"[AIHub welcome] render error:\", e); } catch (_){}\n  }\n})(root_element);",
  "style": ""
 }
]